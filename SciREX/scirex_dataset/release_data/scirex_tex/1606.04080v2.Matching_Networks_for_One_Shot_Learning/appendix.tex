\pagebreak
\section*{Appendix}
\appendix
\section{Model Description}
In this section we fully specify the models which condition the embedding functions $f$ and $g$ on the whole support set $S$. Much previous work has fully described similar mechanisms, which is why we left the precise details for this appendix.
\subsection{The Fully Conditional Embedding \texorpdfstring{$f$}{f}}
As described in section~\ref{sec:fce}, the embedding function for an example $\hat{x}$ in the batch $B$ is as follows:

\begin{equation*}
f(\hat{x},S) = \text{attLSTM}(f'(\hat{x}), g(S), K)
\end{equation*}
where $f'$ is a neural network (e.g., VGG or Inception, as described in the main text). We define $K$ to be the number of ``processing'' steps following work from \cite{vinyals2015order} from their ``Process'' block. $g(S)$ represents the embedding function $g$ applied to each element $x_i$ from the set $S$.

Thus, the state after $k$ processing steps is as follows:

\begin{eqnarray}
\hat{h}_k, c_k &=& \text{LSTM}(f'(\hat{x}), [h_{k-1}, r_{k-1}], c_{k-1}) \label{eq:attlstm}\\
h_k &=& \hat{h}_k + f'(\hat{x})  \label{eq:skip}\\
r_{k-1} &=& \sum_{i=1}^{|S|} a(h_{k-1}, g(x_i)) g(x_i)\\
a(h_{k-1}, g(x_i)) &=& \text{softmax}(h_{k-1}^T g(x_i))\label{eq:att}
\end{eqnarray}
noting that $\text{LSTM}(x,h,c)$ follows the same LSTM implementation defined in \cite{seq2seqilya} with $x$ the input, $h$ the output (i.e., cell after the output gate), and $c$ the cell. $a$ is commonly referred to as ``content'' based attention, and the $\text{softmax}$ in eq.~\ref{eq:att} normalizes w.r.t. $g(x_i)$. The read-out $r_{k-1}$ from $g(S)$ is concatenated to $h_{k-1}$. Since we do $K$ steps of ``reads'', $\text{attLSTM}(f'(\hat{x}), g(S), K) = h_K$ where $h_k$ is as described in eq.~\ref{eq:attlstm}.

\subsection{The Fully Conditional Embedding \texorpdfstring{$g$}{g}}
In section~\ref{sec:fce} we described the encoding function for the elements in the support set $S$, $g(x_i, S)$, as a bidirectional LSTM. More precisely, let $g'(x_i)$ be a neural network (similar to $f'$ above, e.g. a VGG or Inception model). Then we define $g(x_i, S) = \vec{h}_i + \cev{h}_i + g'(x_i)$ with:

\begin{eqnarray*}
\vec{h}_i, \vec{c}_i &=& \text{LSTM}(g'(x_i), \vec{h}_{i-1},\vec{c}_{i-1}) \\
\cev{h}_i, \cev{c}_i &=& \text{LSTM}(g'(x_i), \cev{h}_{i+1},\cev{c}_{i+1}) \\
\end{eqnarray*}
where, as in above,  $\text{LSTM}(x,h,c)$ follows the same LSTM implementation defined in \cite{seq2seqilya} with $x$ the input, $h$ the output (i.e., cell after the output gate), and $c$ the cell. Note that the recursion for $\cev{h}$ starts from $i=|S|$. As in eq.~\ref{eq:skip}, we add a skip connection between input and outputs.

\section{\emph{mini}ImageNet Description}\label{mi_desc}
To construct \emph{mini}ImageNet we chose 100 random classes from ImageNet, and used the first 80 for training, and the last 20 for testing. This split was used in our one-shot experiments described in section~\ref{sec:imagenet}. Note that the last 20 class objects were never seen during training. For the exact 600 images that comprise each of the 100 classes in \emph{mini}ImageNet, please see the following text file: \url{https://goo.gl/e3orz6}

$$L_{train}=$${\scriptsize n01614925, n01632777, n01641577, n01664065, n01687978, n01695060, n01729322, n01773157, n01833805, n01871265, n01877812, n01978455, n01986214, n02013706, n02066245, n02071294, n02088466, n02090379, n02091635, n02096437, n02097130, n02099429, n02108089, n02108915, n02109047, n02109525, n02111889, n02115641, n02123045, n02129165, n02167151, n02206856, n02264363, n02279972, n02342885, n02346627, n02364673, n02454379, n02481823, n02486261, n02494079, n02655020, n02793495, n02804414, n02808304, n02837789, n02895154, n02909870, n02917067, n02966687, n03000684, n03014705, n03041632, n03045698, n03065424, n03180011, n03216828, n03355925, n03384352, n03424325, n03452741, n03482405, n03494278, n03594734, n03599486, n03630383, n03649909, n03676483, n03690938, n03742115, n03868242, n03877472, n03976467, n03976657, n03998194, n04026417, n04069434, n04111531, n04118538, n04200800
\par
}

$$L_{test}=$${\scriptsize n04201297, n04204347, n04239074, n04277352, n04370456, n04409515, n04456115, n04479046, n04487394, n04525038, n04591713, n04599235, n07565083, n07613480, n07695742, n07714571, n07717410, n07753275, n10148035, n12768682
\par
}

\section{ImageNet Class Splits}
Here we define the two class splits used in our full ImageNet experiments -- these classes were excluded for training during our one-shot experiments described in section~\ref{sec:imagenet}.

$$L_{rand}=$${\scriptsize n01498041, n01537544, n01580077, n01592084, n01632777, n01644373, n01665541, n01675722, n01688243, n01729977, n01775062, n01818515, n01843383, n01883070, n01950731, n02002724, n02013706, n02092339, n02093256, n02095314, n02097130, n02097298, n02098413, n02101388, n02106382, n02108089, n02110063, n02111129, n02111500, n02112350, n02115913, n02117135, n02120505, n02123045, n02125311, n02134084, n02167151, n02190166, n02206856, n02231487, n02256656, n02398521, n02480855, n02481823, n02490219, n02607072, n02666196, n02672831, n02704792, n02708093, n02814533, n02817516, n02840245, n02843684, n02870880, n02877765, n02966193, n03016953, n03017168, n03026506, n03047690, n03095699, n03134739, n03179701, n03255030, n03388183, n03394916, n03424325, n03467068, n03476684, n03483316, n03627232, n03658185, n03710193, n03721384, n03733131, n03785016, n03786901, n03792972, n03794056, n03832673, n03843555, n03877472, n03899768, n03930313, n03935335, n03954731, n03995372, n04004767, n04037443, n04065272, n04069434, n04090263, n04118538, n04120489, n04141975, n04152593, n04154565, n04204347, n04208210, n04209133, n04258138, n04311004, n04326547, n04367480, n04447861, n04483307, n04522168, n04548280, n04554684, n04597913, n04612504, n07695742, n07697313, n07697537, n07716906, n12998815, n13133613
\par
}

$$L_{dogs}=$${\scriptsize n02085620, n02085782, n02085936, n02086079, n02086240, n02086646, n02086910, n02087046, n02087394, n02088094, n02088238, n02088364, n02088466, n02088632, n02089078, n02089867, n02089973, n02090379, n02090622, n02090721, n02091032, n02091134, n02091244, n02091467, n02091635, n02091831, n02092002, n02092339, n02093256, n02093428, n02093647, n02093754, n02093859, n02093991, n02094114, n02094258, n02094433, n02095314, n02095570, n02095889, n02096051, n02096177, n02096294, n02096437, n02096585, n02097047, n02097130, n02097209, n02097298, n02097474, n02097658, n02098105, n02098286, n02098413, n02099267, n02099429, n02099601, n02099712, n02099849, n02100236, n02100583, n02100735, n02100877, n02101006, n02101388, n02101556, n02102040, n02102177, n02102318, n02102480, n02102973, n02104029, n02104365, n02105056, n02105162, n02105251, n02105412, n02105505, n02105641, n02105855, n02106030, n02106166, n02106382, n02106550, n02106662, n02107142, n02107312, n02107574, n02107683, n02107908, n02108000, n02108089, n02108422, n02108551, n02108915, n02109047, n02109525, n02109961, n02110063, n02110185, n02110341, n02110627, n02110806, n02110958, n02111129, n02111277, n02111500, n02111889, n02112018, n02112137, n02112350, n02112706, n02113023, n02113186, n02113624, n02113712, n02113799, n02113978
\par
}

\section{PTB Class Splits}
Here we define the two class splits used in our PTB experiments -- these classes were excluded for training during our one-shot language experiments described in section~\ref{sec:ptb}.


$$L_{rand}=$${\scriptsize 's, 12-year, 190.58-point, 1930s, 26-week, a.c., abortion, absorbed, accelerating, acceptable, accords, accusations, achieve, acquires, actively, adapted, addition, adequate, admitting, adopt, adopted, adopting, advised, advisers, advises, advising, aer, affidavits, afternoon, ag, aged, ages, agreements, airport, akzo, alaska, alcohol, alert, alliance, allied-signal, ally, altman, ambrosiano, american, amgen, amount, amounts, an, andy, angry, animals, annuities, antitrust, anybody, anyway, appointed, approaching, approvals, arabs, arafat, arbitration, argentina, arranged, arrest, artists, assembled, associations, assume, assumptions, atoms, attitudes, audio, authorities, authority, away, balls, bally, banknote, banks, banning, barely, barred, barriers, bass, battery, baum, bears, bell, belt, best, best-known, billion, binge, blamed, blanket, bloc, block, blocking, boat, bodies, boesel, bolstered, bonuses, boston, bowed, boys, bozell, bradstreet, brains, breakers, breaks, briefly, brink, brisk, broad-based, broken, bronx, brother, bsn, built, buried, burmah, burned, bursts, bush, businessland, businessman, buys, calculate, calculated, caltrans, campbell, candlestick, capitalism, captured, careers, carpeting, carried, carry-forward, casting, castle, catholic, caught, ceiling, cells, centuries, chair, chairs, challenged, chances, chandler, characters, charts, cheating, checks, cherry, chiron, cie, cie., cincinnati, circuit, civic, clara, classroom, clean-air, climate, closer, cms, cnw, coast, coats, cocom, cold, collected, comes, commercial, commerzbank, commissioned, committed, commute, complains, completing, computer, confirm, confiscated, confronted, conn, conn., consisting, consortium, constitute, consultant, consumer, consumers, contemporary, contra, contraceptive, contributing, convinced, cost-cutting, count, counterparts, counties, courses, cover, cracks, craft, crane, create, creating, crossing, crumbling, crusade, crusaders, cubic, curtail, curve, cushion, cut, cynthia, dairy, dam, david, davis, day, deal, dealerships, debentures, debut, deceptive, decided, decision, decisions, deck, defended, defenders, defenses, definitely, delivering, della, demonstrated, department, departure, depress, designated, desk, desktop, detailing, devaluation, develops, devoe, di, dialogue, dictator, die, diesel, differ, digs, diluted, diminished, direct-mail, disappointing, discount, discrepancies, discuss, disease, disney, disruption, distributed, distributor, dive, diversified, divided, dividends, dodge, doing, domestic, dominant, domination, double-a, downgraded, downgrading, downtown, drives, drought, drunk, dunkin, earn, earthquakes, edisto, editions, educate, eggs, elaborate, elite, embarrassing, emerges, emerging, emigration, employers, empty, enactment, encourages, endorsement, enemies, engelken, enhanced, entertaining, enthusiastic, epicenter, equipped, era, erosion, esselte, est, ethical, ethiopia, eurodollar, events, everyone, exchanges, exciting, exclusively, executed, executing, executive, executives, exempt, expertise, explicit, explosion, expressed, expression, extending, extraordinary, faculty, failed, failure, fallout, faltered, fanfare, fare, farm, fast-growing, fasteners, fastest, fax, fazio, february, federated, fee, field, fifth, fighting, filipino, film, final, financiers, finished, finland, firmed, fiscal, fits, fitzwater, five-cent, fixed-income, fla, flamboyant, fleets, fleming, fletcher, flight, flights, flowers, focus, folk, following, foot, forecasting, found, fox, fray, freeway, freeways, freeze, frequency, freshman, fromstein, frustrating, fur, galileo, game, gandhi, garbage, gathered, gave, gear, gene, generale, genuine, gerard, giant, girl, gloomy, goes, golden, goodman, gov., governing, government-owned, governor, grave, greenhouse, gridlock, grim, guerrilla, guild, gun, h\&r, half-hour, handicapped, handy, hanging, happening, happy, harold, haunts, headed, heating, heavier, heavily, hedges, heights, heller, helping, helps, hepatitis, hess, high-definition, high-technology, hiring, hoffman, hold, hole, homeless, honduras, hooker, horizon, hot-dipped, houses, how, hubbard, hurricane, hydro-quebec, hyman, idaho, ill, illness, illustrated, immune, impeachment, implicit, impose, impression, impressive, increase, incredible, incurred, indexing, indiana, indicates, indications, influences, influx, inherent, inquiry, intensive, intentions, internationally, involves, irish, ironically, isler, itel, itt, j., jackson, jaguar, jazz, jefferson, jittery, jolted, july, jump, jury, justifies, karen, kean, keating, kent, kgb, khan, killing, knocked, knocking, koch, l.j., labs, lasts, lately, latest, lawrence, league, lean, least, leave, legitimacy, lehman, leisure, lend, leo, life, lighter, lights, linda, line, literature, live, living, longstanding, looking, looks, loral, lord, lose, lotus, louisville, lower, ltd., luis, lumpur, made, madrid, malcolm, male, manage, management, manic, manville, marcos, marked, market-makers, market-share, markets, mary, mass-market, mayor, mccormick, mcdonald, md., measured, member, members, memorandum, merabank, mercury, merely, merged, mergers, message, mich., mile, millions, mining, ministers, ministry, minorities, minutes, missile, mission, mitterrand, modified, monitor, months, moody, moore, mothers, motorola, movie, mr., much, multibillion-dollar, multiples, mundane, municipalities, muscle, mutual, mutual-fund, named, names, namibia, nashua, nathan, ncr, near-term, nec, necessary, necessity, negligence, negotiating, negotiation, nervousness, newcomers, newspaper, nice, noise, northrop, norton, nose, nothing, noticed, notification, notified, notwithstanding, november, nurses, nutritional, observed, oddly, off, offerings, official, oh, oklahoma, oldest, olympic, ones, opening, opera, optical, optimistic, or, original, orthodox, ortiz, ousted, outfit, outlook, outside, oversees, owen, oy, pachinko, packaged, painted, park, parker, part, particular, partly, patrick, patterson, payable, pc, peace, peaked, peddling, pegged, pepsico, perception, perfect, perfectly, pfizer, pharmaceutical, phelan, philippine, philippines, phony, photographic, physicians, picking, pigs, pittsburgh, place, plagued, plan, planes, planet, pleasure, poles, pool, portable, portfolio, ports, post-crash, pound, poured, poverty, precedent, preclude, pregnant, prescribed, presents, pretty, priced, privileges, procurement, products, profit-taking, projections, prominent, promise, promotional, prompted, proper, proponents, propose, prosecuted, protein, prototype, prove, proved, published, publisher, pull, pulled, pumped, pumping, pushing, quebec, quickview, quist, quite, radical, radio, rain, ranging, rank, rebates, rebel, rebound, rebuild, recent, recital, recognizes, recognizing, recorded, recorders, reduce, reduced, refinery, refrigerators, registered, regret, reinvest, rejected, rejecting, rejection, relations, relatively, relying, remark, remics, reorganization, repaired, repeatedly, reports, represent, repurchase, resembles, reserved, resisted, resolved, resort, rest, restraints, restrictions, restructured, restructuring, result, rican, right, ring, rise, robbed, robinson, robots, robust, roh, role, rolled, rose, rothschild, rough, royal, ruled, rushing, s.c, sale, salesmen, salespeople, salmonella, salvage, saul, says, scheduled, school, schwarz, seagram, second, sector, securities, seek, segment, seismic, seldom, selected, semel, sending, sentences, sentencing, session, settlement, seventh, shed, shell, sheraton, shifting, shocks, short, showed, shy, sigh, sights, signals, sir, site, sites, sitting, skinner, slashed, snapped, so-called, soldiers, solely, solo, somehow, sotheby, speak, specialist, specialize, specializing, specifically, specifications, speculate, speculated, spencer, sperry, spreading, spur, stake, standardized, standing, statistics, steady, stemmed, stern, stevens, stock-index, stockholm, straight, strategists, stream, strength, stress-related, strict, subscriber, suggestions, surplus, surprise, surprises, surrounding, syrian, taiwanese, tall, tap, tapped, task, taxation, taxed, tci, technicians, televised, temptation, testing, texans, theatre, third, this, thomas, those, thoughts, thriving, tickets, ties, tiger, tighter, tire, tisch, together, toronto-based, toshiba, towers, toxin, traditional, trains, transit, trap, treated, trecker, tribune, trigger, triggering, trillion, tube, tune, turn, turnaround, typically, u.k., u.n., uncertain, underlying, underwear, underwrite, underwriter, underwriting, undo, unfortunately, unidentified, unilab, unisys, unit, unknown, unlawful, unless, unused, upheld, upon, upside, urge, usia, uv-b, valid, van, vendors, very, victim, vienna, violations, virginia, vision, visit, voluntary, w., wade, wait, wanting, ward, warner, wars, wary, wash., wealthy, wednesday, when-issued, whether, white-collar, wholly, widening, will, willingness, wilmington, win, winnebago, winners, wish, wolf, words, work, working, worse, would, yard, yards, yearly, yielding, youth, z, zones
\par
}
