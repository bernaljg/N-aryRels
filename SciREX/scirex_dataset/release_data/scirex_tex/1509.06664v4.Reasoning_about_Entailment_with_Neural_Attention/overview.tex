\documentclass{standalone}

\usepackage{tikz}
\usepackage{preview}
\usepackage{xcolor}

\usetikzlibrary{arrows}
\usetikzlibrary{decorations.text}

\definecolor{nice-red}{HTML}{E41A1C}
\definecolor{nice-orange}{HTML}{FF7F00}
\definecolor{nice-yellow}{HTML}{FFC020}
\definecolor{nice-green}{HTML}{4DAF4A}
\definecolor{nice-blue}{HTML}{377EB8}
\definecolor{nice-purple}{HTML}{984EA3}



\makeatletter
\let\Test@pr@shipout\pr@shipout%% save the original definition
\let\Test@shipout\shipout
\AtBeginDocument{%
  \let\pr@shipout\Test@pr@shipout%% restore it 
  \let\shipout\Test@shipout
}
\makeatother

\PreviewEnvironment{tikzpicture}

\begin{document}
\begin{tikzpicture}[scale=1.2]
\foreach \i/\l in {1/1,2/2,3/3,4/4,5/5} {
  \path[draw, thick, fill=nice-yellow!5] (\i-0.2,0) rectangle (\i+0.2,0.75) {};
  \path[draw, thick, fill=nice-yellow!5] (\i-0.2,1) rectangle (\i+0.2,1.75) {};
  \path[draw, thick, fill=nice-yellow!5] (\i-0.2,2) rectangle (\i+0.2,2.75) {};
  \draw[->, >=stealth', thick] (\i,0.75) -- (\i,1);
  \draw[->, >=stealth', thick] (\i,1.75) -- (\i,2);
  \node[] at (\i,0.4) {$\mathbf{x}_\l$};
  \node[] at (\i,1.4) {$\mathbf{c}_\l$};
  \node[] at (\i,2.4) {$\mathbf{h}_\l$};
}
\foreach \i/\l in {6/6,7/7,8/8,9/9} {
  \path[draw, thick, fill=nice-green!5] (\i-0.2,0) rectangle (\i+0.2,0.75) {};
  \path[draw, thick, fill=nice-green!5] (\i-0.2,1) rectangle (\i+0.2,1.75) {};
  \path[draw, thick, fill=nice-green!5] (\i-0.2,2) rectangle (\i+0.2,2.75) {};
  \draw[->, >=stealth', thick] (\i,0.75) -- (\i,1);
  \draw[->, >=stealth', thick] (\i,1.75) -- (\i,2);
  \node[] at (\i,0.4) {$\mathbf{x}_\l$};
  \node[] at (\i,1.4) {$\mathbf{c}_\l$};
  \node[] at (\i,2.4) {$\mathbf{h}_\l$};
}
\foreach \i in {1,2,3,4,5,6,7,8} {
  \draw[->, >=stealth', thick] (\i+0.2,1.4) -- (\i+1-0.2,1.4);
}

\foreach \i/\word in {1/A, 2/wedding, 3/party, 4/taking, 5/pictures, 6/::, 7/Someone, 8/got, 9/married} {
  \node[anchor=north, text height=1.5ex, text depth=.25ex] at (\i,0) {\word};
}
\foreach \i in {1,2,3,4,5} {
  \path[draw, ultra thick, color=nice-blue] (9,2.75) edge [bend right] (\i,2.75);
}

\foreach \i in {1,2,3,4,5} {
  \path[draw, ultra thick, color=nice-blue!50!nice-purple] (8,2.75) edge [bend right] (\i,2.75);
}

\foreach \i in {1,2,3,4,5} {
  \path[draw, ultra thick, color=nice-purple] (7,2.75) edge [bend right] (\i,2.75);
}

\draw[ultra thick, nice-yellow] (1,-0.5) -- (5,-0.5);
\draw[ultra thick, nice-green] (7,-0.5) -- (9,-0.5);

\node[anchor=north] at (3,-0.5) {Premise};
\node[anchor=north] at (8,-0.5) {Hypothesis};

\draw[ultra thick, color=gray, densely dotted] (0.25,0.05) -- (0.25,2.7);
\node[anchor=east, align=right] at (0.2,1.4) {(\textbf{A}) Conditional\\ Encoding};

\draw[ultra thick, color=gray, densely dotted] (0.25,2.85) -- (0.25,3.9);
\node[anchor=east, align=right] at (0.2,3.4) {(\textbf{C}) Word-by-word\\ Attention};
\node[rotate=0] (att) at (8.7, 3.7) {(\textbf{B}) Attention};
\draw[->] (att) -- (8.7, 3);

\end{tikzpicture}
\end{document}